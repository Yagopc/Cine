<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extractor de URLs de Dailymotion con Múltiples Proxies</title>
    <style>
        :root {
            --primary: #0066cc;
            --secondary: #00a1ff;
            --accent: #ff5722;
            --light: #f5f9ff;
            --dark: #333;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 1000px;
            padding: 30px;
            margin-top: 20px;
        }
        
        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 15px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            text-align: center;
            color: var(--accent);
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .description {
            text-align: center;
            margin-bottom: 25px;
            color: #555;
            line-height: 1.6;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .proxy-selector {
            margin: 20px 0;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .proxy-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .proxy-option {
            flex: 1;
            min-width: 200px;
        }
        
        .proxy-option input[type="radio"] {
            margin-right: 8px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .center-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .result-container {
            margin-top: 30px;
            display: none;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .result-title {
            font-size: 1.4rem;
            color: var(--primary);
        }
        
        .url-list {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            background-color: var(--light);
        }
        
        .url-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            word-break: break-all;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .url-item:last-child {
            border-bottom: none;
        }
        
        .url-text {
            flex-grow: 1;
            margin-right: 10px;
        }
        
        .url-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        .loader {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .loader-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: var(--danger);
            text-align: center;
            margin-top: 20px;
            display: none;
            padding: 10px;
            background-color: #f8d7da;
            border-radius: 4px;
            border: 1px solid #f5c6cb;
        }
        
        .success {
            color: var(--success);
            text-align: center;
            margin-top: 20px;
            display: none;
            padding: 10px;
            background-color: #d4edda;
            border-radius: 4px;
            border: 1px solid #c3e6cb;
        }
        
        .instructions {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .instructions h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .instructions ol {
            margin-left: 20px;
            line-height: 1.8;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        .api-info {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--warning);
        }
        
        .api-info h3 {
            color: var(--warning);
            margin-bottom: 10px;
        }
        
        .proxy-status {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                width: 95%;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .center-buttons {
                flex-direction: column;
            }
            
            .result-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .proxy-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Extractor de URLs de Dailymotion</h1>
        <p class="subtitle">Con múltiples proxies CORS alternativos</p>
        
        <div class="description">
            <p>Esta herramienta te permite extraer las URLs de videos de listas públicas de Dailymotion utilizando diferentes proxies CORS.</p>
            <p><strong>Nota:</strong> Si un proxy no funciona, prueba con otro de la lista.</p>
        </div>
        
        <div class="input-group">
            <label for="playlist-url">URL de la lista de Dailymotion:</label>
            <input type="text" id="playlist-url" placeholder="Ej: https://www.dailymotion.com/playlist/x123abc">
        </div>
        
        <div class="proxy-selector">
            <label>Selecciona un proxy CORS:</label>
            <div class="proxy-options">
                <div class="proxy-option">
                    <input type="radio" id="proxy1" name="proxy" value="https://cors-anywhere.herokuapp.com/" checked>
                    <label for="proxy1">Cors Anywhere (Heroku)</label>
                </div>
                <div class="proxy-option">
                    <input type="radio" id="proxy2" name="proxy" value="https://api.allorigins.win/raw?url=">
                    <label for="proxy2">AllOrigins</label>
                </div>
                
                
                <div class="proxy-option">
                    <input type="radio" id="proxy3" name="proxy" value="https://cors.bridged.cc/">
                    <label for="proxy3">CORS Bridged</label>
                </div>
                
                <div class="proxy-option">
                    <input type="radio" id="proxy4" name="proxy" value="https://proxy.cors.sh/">
                    <label for="proxy4">CORS.sh</label>
                </div>
            </div>
            <div class="proxy-status" id="proxy-status">Proxy seleccionado: Cors Anywhere (Heroku)</div>
        </div>
        
        
        
        
        <div class="center-buttons">
            <button id="extract-btn" class="btn btn-primary">Extraer URLs</button>
            <button id="test-proxies-btn" class="btn btn-warning">Probar Proxies</button>
            <button id="clear-btn" class="btn btn-danger">Limpiar</button>
        </div>
        
        <div class="loader" id="loader">
            <div class="loader-spinner"></div>
            <p id="loader-text">Extrayendo URLs, por favor espera...</p>
        </div>
        
        <div class="error" id="error"></div>
        <div class="success" id="success"></div>
        
        <div class="result-container" id="result-container">
            <div class="result-header">
                <h2 class="result-title">URLs Extraídas</h2>
                <div>
                    <button class="btn btn-success btn-sm" id="copy-btn">Copiar Todas</button>
                    <button class="btn btn-primary btn-sm" id="export-btn">Exportar</button>
                </div>
            </div>
            <div class="url-list" id="url-list"></div>
        </div>
        
        <div class="api-info">
            <h3>Proxies CORS disponibles</h3>
            <p>Esta herramienta utiliza diferentes proxies CORS para evitar restricciones de los navegadores. Si uno falla, puedes probar con otro.</p>
        </div>
        
        <div class="instructions">
            <h3>Instrucciones:</h3>
            <ol>
                <li>Pega la URL de una lista pública de Dailymotion</li>
                <li>Selecciona un proxy CORS (si uno no funciona, prueba con otro)</li>
                <li>Haz clic en "Extraer URLs"</li>
                <li>Si tienes problemas, usa el botón "Probar Proxies" para encontrar el que funcione mejor</li>
                <li>Copia o exporta las URLs encontradas</li>
            </ol>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const extractBtn = document.getElementById('extract-btn');
            const testProxiesBtn = document.getElementById('test-proxies-btn');
            const clearBtn = document.getElementById('clear-btn');
            const playlistUrlInput = document.getElementById('playlist-url');
            const loader = document.getElementById('loader');
            const loaderText = document.getElementById('loader-text');
            const errorDiv = document.getElementById('error');
            const successDiv = document.getElementById('success');
            const resultContainer = document.getElementById('result-container');
            const urlList = document.getElementById('url-list');
            const copyBtn = document.getElementById('copy-btn');
            const exportBtn = document.getElementById('export-btn');
            const proxyStatus = document.getElementById('proxy-status');
            const proxyRadios = document.querySelectorAll('input[name="proxy"]');
            
            // Actualizar texto del proxy seleccionado
            proxyRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const proxyName = this.parentElement.querySelector('label').textContent;
                    proxyStatus.textContent = `Proxy seleccionado: ${proxyName}`;
                });
            });
            
            // URL de ejemplo para pruebas
            playlistUrlInput.value = 'https://www.dailymotion.com/playlist/x7mngz';
            
            extractBtn.addEventListener('click', function() {
                const playlistUrl = playlistUrlInput.value.trim();
                
                if (!playlistUrl) {
                    showError('Por favor, ingresa una URL válida de Dailymotion');
                    return;
                }
                
                if (!isValidDailymotionUrl(playlistUrl)) {
                    showError('La URL ingresada no parece ser una lista de Dailymotion válida');
                    return;
                }
                
                // Obtener proxy seleccionado
                const selectedProxy = document.querySelector('input[name="proxy"]:checked').value;
                
                // Limpiar resultados anteriores
                hideMessages();
                resultContainer.style.display = 'none';
                urlList.innerHTML = '';
                
                // Mostrar loader
                loader.style.display = 'block';
                loaderText.textContent = 'Extrayendo URLs, por favor espera...';
                
                // Extraer URLs
                extractUrls(playlistUrl, selectedProxy);
            });
            
            testProxiesBtn.addEventListener('click', function() {
                const playlistUrl = playlistUrlInput.value.trim();
                
                if (!playlistUrl) {
                    showError('Por favor, ingresa una URL válida de Dailymotion para probar los proxies');
                    return;
                }
                
                hideMessages();
                loader.style.display = 'block';
                loaderText.textContent = 'Probando proxies, por favor espera...';
                
                testProxies(playlistUrl);
            });
            
            clearBtn.addEventListener('click', function() {
                playlistUrlInput.value = '';
                hideMessages();
                resultContainer.style.display = 'none';
                urlList.innerHTML = '';
            });
            
            copyBtn.addEventListener('click', function() {
                const urls = Array.from(urlList.querySelectorAll('.url-text'))
                    .map(item => item.textContent)
                    .join('\n');
                
                navigator.clipboard.writeText(urls)
                    .then(() => {
                        showSuccess('¡URLs copiadas al portapapeles!');
                    })
                    .catch(err => {
                        showError('No se pudieron copiar las URLs: ' + err);
                    });
            });
            
            exportBtn.addEventListener('click', function() {
                const urls = Array.from(urlList.querySelectorAll('.url-text'))
                    .map(item => item.textContent)
                    .join('\n');
                
                const blob = new Blob([urls], { type: 'text/plain' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'urls-dailymotion.txt';
                a.click();
            });
            
            function isValidDailymotionUrl(url) {
                return url.includes('dailymotion.com') && url.includes('playlist');
            }
            
            function extractUrls(playlistUrl, proxyUrl) {
                let targetUrl = proxyUrl + encodeURIComponent(playlistUrl);
                
                // Ajuste para el proxy de AllOrigins que ya incluye el parámetro
                if (proxyUrl.includes('allorigins')) {
                    targetUrl = proxyUrl + playlistUrl;
                }
                
                fetch(targetUrl, {
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Error al cargar la lista mediante el proxy');
                    }
                    return response.text();
                })
                .then(html => {
                    // Parsear el HTML para extraer las URLs
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Buscar todos los enlaces de videos
                    const videoLinks = doc.querySelectorAll('a[href*="/video/"]');
                    
                    if (videoLinks.length === 0) {
                        throw new Error('No se encontraron videos en esta lista');
                    }
                    
                    // Extraer URLs únicas
                    const uniqueUrls = new Set();
                    videoLinks.forEach(link => {
                        const href = link.getAttribute('href');
                        if (href && href.includes('/video/')) {
                            let url = href.startsWith('http') ? href : `https://www.dailymotion.com${href}`;
                            // Asegurarnos de que la URL tenga el formato correcto
                            url = url.split('?')[0]; // Eliminar parámetros de consulta
                            uniqueUrls.add(url);
                        }
                    });
                    
                    // Mostrar las URLs
                    showUrls(Array.from(uniqueUrls));
                })
                .catch(error => {
                    loader.style.display = 'none';
                    showError('Error con el proxy: ' + error.message + '. Prueba con otro proxy.');
                });
            }
            
            function testProxies(playlistUrl) {
                const proxies = [
                    { url: 'https://cors-anywhere.herokuapp.com/', name: 'Cors Anywhere' },
                    { url: 'https://api.allorigins.win/raw?url=', name: 'AllOrigins' },
                    { url: 'https://cors.bridged.cc/', name: 'CORS Bridged' },
                    { url: 'https://proxy.cors.sh/', name: 'CORS.sh' }
                ];
                
                let workingProxy = null;
                let tested = 0;
                
                proxies.forEach(proxy => {
                    let targetUrl = proxy.url + encodeURIComponent(playlistUrl);
                    
                    if (proxy.url.includes('allorigins')) {
                        targetUrl = proxy.url + playlistUrl;
                    }
                    
                    fetch(targetUrl, {
                        headers: {
                            'X-Requested-With': 'XMLHttpRequest'
                        }
                    })
                    .then(response => {
                        if (response.ok) {
                            workingProxy = proxy;
                            // Seleccionar este proxy en la interfaz
                            document.querySelector(`input[value="${proxy.url}"]`).checked = true;
                            proxyStatus.textContent = `Proxy seleccionado: ${proxy.name} (funciona)`;
                            
                            // Extraer URLs con este proxy
                            extractUrls(playlistUrl, proxy.url);
                            return;
                        }
                        throw new Error('Proxy no funciona');
                    })
                    .catch(error => {
                        tested++;
                        if (tested === proxies.length && !workingProxy) {
                            loader.style.display = 'none';
                            showError('Ninguno de los proxies funciona en este momento. Intenta más tarde.');
                        }
                    });
                });
            }
            
            function showUrls(urls) {
                loader.style.display = 'none';
                
                if (urls.length === 0) {
                    showError('No se encontraron URLs en esta lista');
                    return;
                }
                
                // Mostrar las URLs en la lista
                urls.forEach(url => {
                    const urlItem = document.createElement('div');
                    urlItem.classList.add('url-item');
                    
                    const urlText = document.createElement('span');
                    urlText.classList.add('url-text');
                    urlText.textContent = url;
                    
                    const urlActions = document.createElement('div');
                    urlActions.classList.add('url-actions');
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.classList.add('btn', 'btn-primary', 'btn-sm');
                    copyBtn.textContent = 'Copiar';
                    copyBtn.addEventListener('click', () => {
                        navigator.clipboard.writeText(url)
                            .then(() => {
                                showSuccess('URL copiada al portapapeles');
                            })
                            .catch(err => {
                                showError('No se pudo copiar la URL: ' + err);
                            });
                    });
                    
                    const openBtn = document.createElement('button');
                    openBtn.classList.add('btn', 'btn-success', 'btn-sm');
                    openBtn.textContent = 'Abrir';
                    openBtn.addEventListener('click', () => {
                        window.open(url, '_blank');
                    });
                    
                    urlActions.appendChild(copyBtn);
                    urlActions.appendChild(openBtn);
                    
                    urlItem.appendChild(urlText);
                    urlItem.appendChild(urlActions);
                    
                    urlList.appendChild(urlItem);
                });
                
                resultContainer.style.display = 'block';
                showSuccess(`Se encontraron ${urls.length} URLs en la lista`);
            }
            
            function showError(message) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }
            
            function showSuccess(message) {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
                // Ocultar después de 3 segundos
                setTimeout(hideMessages, 3000);
            }
            
            function hideMessages() {
                errorDiv.style.display = 'none';
                successDiv.style.display = 'none';
            }
        });
    </script>
</body>
</html>